angular.module("schemaForm").run(["$templateCache",function(e){e.put("directives/decorators/bootstrap/file/file.html",'<div class="form-group" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div assureit-decorator-upload="" ng-show="form.key" type="text" sf-changed="form" placeholder="{{form.placeholder}}" ng-model-options="form.ngModelOptions" ng-model="$$value$$" schema-validate="form"></div><span ng-if="form.feedback !== false" class="form-control-feedback" ng-class="evalInScope(form.feedback) || {\'glyphicon\': true, \'glyphicon-ok\': hasSuccess(), \'glyphicon-remove\': hasError() }"></span><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>')}]),angular.module("schemaForm").config(["schemaFormProvider","schemaFormDecoratorsProvider","sfPathProvider",function(e,r,a){var o=function(r,o,s){if("object"===o.type&&"file"===o.format){var t=e.stdFormObj(r,o,s);return t.key=s.path,t.type="file",s.lookup[a.stringify(s.path)]=t,t}};e.defaults.string.unshift(o),r.addMapping("bootstrapDecorator","file","directives/decorators/bootstrap/file/file.html"),r.createDirective("file","directives/decorators/bootstrap/file/file.html")}]).directive("assureitDecoratorUpload",function(e,r,a,o,s){return{template:'<div ng-hide="data" class="form-control">	<input ng-disabled="form.readonly" ng-hide="inProgress > 0" type="file" ng-file-select="upload($files)">	<div ng-show="inProgress" class="progress">	  <div class="progress-bar progress-bar-striped active" role="progressbar" style="width: 100%"></div>	</div></div><div ng-show="data">  <div style="margin: 5px; padding-right: 35px; font-weight: bold;" ng-bind-html="data.name"></div>  <div style="margin-right: 35px;" class="btn btn-default" ng-click="download()">הורד קובץ</div>  <div ng-disabled="form.readonly" class="btn btn-danger" ng-click="remove()"><i class="glyphicon glyphicon-trash"></i> מחק קובץ</div></div>',restrict:"A",scope:!1,require:"ngModel",link:function(o,t,i,l){o.inProgress=!1,o.data=a(o.form.key,o.model),o.upload=function(r){o.inProgress=!0,e.upload({url:"/upload",method:"POST",data:{},file:r}).success(function(e){o.inProgress=!1,o.data=e,l.$setViewValue(e),o.$emit("schemaFormValidate")}).error(function(){o.inProgress=!1,alert("There was an issue uploading your file. Please try again.")})},o.remove=function(){l.$setViewValue(void 0),o.data=void 0},o.download=function(){var e=window.document.getElementById("downloads");e?e.src=o.data.url:r.open(o.data.url)};var d;o.validateArray=function(){var e,r=s.validate(o.form,o.data);o.form.accept&&(e=new RegExp(o.form.accept.replace(/,\s*/g,"|")+"$","i")),o.form.accept&&o.data&&o.data.url&&!e.test(o.data.url)?(l.$setViewValue(o.data),d={code:302,schemaPath:"/",message:"קובץ מסוג לא תקין. סניתן להעלות קבצים מסוג: "+o.form.accept},l.$setValidity("schema",!1)):r.valid!==!1||!r.error||""!==r.error.dataPath&&r.error.dataPath!=="/"+o.form.key[o.form.key.length-1]?l.$setValidity("schema",!0):(l.$setViewValue(o.data),d=r.error,l.$setValidity("schema",!1))},o.$on("schemaFormValidate",o.validateArray),o.hasSuccess=function(){return l.$valid&&!l.$pristine},o.hasError=function(){return console.log("hasError",l.$invalid),l.$invalid},o.schemaError=function(){return console.log("schemaError",d),d}}}});